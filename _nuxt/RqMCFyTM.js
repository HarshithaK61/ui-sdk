import{d as w,j as i,l as _,O as b,x as h,o as C,y as d,e as y,I as k,a as u,n as S,F as x,K as D}from"./CIKIahH0.js";import{u as K,C as P}from"./f7xkK54W.js";import"./Byf87tck.js";import"./8NJXV5Ny.js";const E={class:"container mx-auto p-4"},A=w({__name:"sdk-managed",setup(q){const t=i(!1),s=i(!1),a=i(null),{requestChallengeFromBackend:v,verifyPresentationProof:p}=K(a),m=async()=>{if(t.value=!t.value,!!t.value){a.value||g();try{await a.value.renderUIModals()}catch(o){console.error("SDK-managed mode error:",o),t.value=!1}}},g=()=>{a.value=new P({network:"testnet",projectId:"60b3730563f0be9f7ed3776d813f6498",metadata:{name:"Concordium Merchant SDK",description:"Merchant dApp using Concordium ID verification",url:window.location.origin,icons:[`${window.location.origin}/Concordium.png`]}})},f=async(o,e)=>{if(!o)throw new Error("No challenge data available");await a.value?.sendPresentationRequest(o?.presentationRequest,e?.topic)},l=async o=>{try{console.log("handleChallengeAndPresentationRequest called with sessionData:",o);const e=await v();await f(e,o)}catch(e){console.error("Error in challenge/presentation flow:",e)}},c=async o=>{const{type:e,data:n}=o.detail;switch(console.log("SDK Event:",e,n),e){case"active_session":s.value=!0,console.log("Active session detected:",n),await l(n);break;case"session_approved":s.value=!0,console.log("Session approved!",n),await new Promise(r=>setTimeout(r,500)),await l(n);break;case"presentation_received":console.log("Presentation received:",n),await p(n);break;case"session_disconnected":s.value=!1,t.value=!1,console.log("Session disconnected:",n);break;case"error":console.error("SDK Error:",n),t.value=!1;break}};return _(()=>{window.addEventListener("verification-web-ui-event",c)}),b(()=>{window.removeEventListener("verification-web-ui-event",c)}),(o,e)=>{const n=k,r=D;return C(),h(r,null,{default:d(()=>[y(n,null,{default:d(()=>[u("div",E,[u("button",{onClick:e[0]||(e[0]=B=>m()),class:S(["px-6 py-2 rounded-lg font-medium transition-colors border",t.value?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-900 border-gray-300 hover:bg-gray-50"])},x(s.value?"Connected":t.value?"Connecting...":"Connect SDK Wallet"),3)])]),_:1})]),_:1})}}});export{A as default};
